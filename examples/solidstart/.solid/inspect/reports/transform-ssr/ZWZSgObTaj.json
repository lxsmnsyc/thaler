{"resolvedId":"D:/Files/Github/thaler/node_modules/.pnpm/solid-start@0.2.26_@solidjs+meta@0.28.2_@solidjs+router@0.8.2_solid-js@1.7.2_solid-start-node@0.2.19_vite@4.2.1/node_modules/solid-start/root/Links.tsx","transforms":[{"name":"__load__","result":"import { JSXElement, useContext } from \"solid-js\";\nimport { useAssets } from \"solid-js/web\";\nimport { ServerContext } from \"../server/ServerContext\";\nimport type { IslandManifest, ManifestEntry, PageEvent } from \"../server/types\";\nimport { routeLayouts } from \"./InlineStyles\";\n\ntype NotUndefined<T> = T extends undefined ? never : T;\n\ntype RouterContext = NotUndefined<PageEvent[\"routerContext\"]>\n\nfunction flattenIslands(match: ManifestEntry[], manifest: Record<string, ManifestEntry> | IslandManifest) {\n  let result = [...match];\n  match.forEach(m => {\n    if (m.type !== \"island\") return;\n    const islandManifest = manifest[m.href as keyof typeof manifest] as unknown as IslandManifest | undefined;\n    if (islandManifest) {\n      const res = flattenIslands((islandManifest as IslandManifest).assets, manifest);\n      result.push(...res);\n    }\n  });\n  return result;\n}\n\nfunction getAssetsFromManifest(\n  manifest: PageEvent[\"env\"][\"manifest\"],\n  routerContext: RouterContext\n) {\n  let match = routerContext.matches ? routerContext.matches.reduce<ManifestEntry[]>((memo, m) => {\n    if (m.length) {\n      const fullPath = m.reduce((previous, match) => previous + match.originalPath, \"\");\n      const route = routeLayouts[fullPath];\n      if (route) {\n        memo.push(...((manifest![route.id] || []) as ManifestEntry[]));\n        const layoutsManifestEntries = route.layouts.flatMap(\n          manifestKey => (manifest![manifestKey as keyof typeof manifest] || []) as ManifestEntry[]\n        );\n        memo.push(...layoutsManifestEntries);\n      }\n    }\n    return memo;\n  }, []) : [];\n\n  match.push(...((manifest![\"entry-client\"] || []) as ManifestEntry[]));\n\n  match = manifest ? flattenIslands(match, manifest as any) : [];\n\n  const links = match.reduce((r, src) => {\n    r[src.href] =\n      src.type === \"style\" ? (\n        <link rel=\"stylesheet\" href={src.href} $ServerOnly />\n      ) : src.type === \"script\" ? (\n        <link rel=\"modulepreload\" href={src.href} $ServerOnly />\n      ) : undefined;\n    return r;\n  }, {} as Record<string, JSXElement>);\n\n  return Object.values(links);\n}\n\n/**\n * Links are used to load assets for the server rendered HTML\n * @returns {JSXElement}\n */\nexport default function Links() {\n  const isDev = import.meta.env.MODE === \"development\";\n  const context = useContext(ServerContext);\n  !isDev &&\n    import.meta.env.START_SSR &&\n    useAssets(() => getAssetsFromManifest(context!.env.manifest, context!.routerContext!));\n  return null;\n}\n","start":1681089269428,"end":1681089269428},{"name":"solid","result":"import { ssr as _$ssr } from \"solid-js/web\";\nimport { ssrAttribute as _$ssrAttribute } from \"solid-js/web\";\nimport { escape as _$escape } from \"solid-js/web\";\nimport { ssrHydrationKey as _$ssrHydrationKey } from \"solid-js/web\";\nconst _tmpl$ = [\"<link\", \" rel=\\\"stylesheet\\\"\", \">\"],\n  _tmpl$2 = [\"<link\", \" rel=\\\"modulepreload\\\"\", \">\"];\nimport { useContext } from \"solid-js\";\nimport { useAssets } from \"solid-js/web\";\nimport { ServerContext } from \"../server/ServerContext\";\nimport { routeLayouts } from \"./InlineStyles\";\nfunction flattenIslands(match, manifest) {\n  let result = [...match];\n  match.forEach(m => {\n    if (m.type !== \"island\") return;\n    const islandManifest = manifest[m.href];\n    if (islandManifest) {\n      const res = flattenIslands(islandManifest.assets, manifest);\n      result.push(...res);\n    }\n  });\n  return result;\n}\nfunction getAssetsFromManifest(manifest, routerContext) {\n  let match = routerContext.matches ? routerContext.matches.reduce((memo, m) => {\n    if (m.length) {\n      const fullPath = m.reduce((previous, match) => previous + match.originalPath, \"\");\n      const route = routeLayouts[fullPath];\n      if (route) {\n        memo.push(...(manifest[route.id] || []));\n        const layoutsManifestEntries = route.layouts.flatMap(manifestKey => manifest[manifestKey] || []);\n        memo.push(...layoutsManifestEntries);\n      }\n    }\n    return memo;\n  }, []) : [];\n  match.push(...(manifest[\"entry-client\"] || []));\n  match = manifest ? flattenIslands(match, manifest) : [];\n  const links = match.reduce((r, src) => {\n    r[src.href] = src.type === \"style\" ? _$ssr(_tmpl$, _$ssrHydrationKey(), _$ssrAttribute(\"href\", _$escape(src.href, true), false)) : src.type === \"script\" ? _$ssr(_tmpl$2, _$ssrHydrationKey(), _$ssrAttribute(\"href\", _$escape(src.href, true), false)) : undefined;\n    return r;\n  }, {});\n  return Object.values(links);\n}\n\n/**\n * Links are used to load assets for the server rendered HTML\n * @returns {JSXElement}\n */\nexport default function Links() {\n  const isDev = import.meta.env.MODE === \"development\";\n  const context = useContext(ServerContext);\n  !isDev && import.meta.env.START_SSR && useAssets(() => getAssetsFromManifest(context.env.manifest, context.routerContext));\n  return null;\n}","start":1681089269428,"end":1681089269438,"order":"pre"},{"name":"vite:define","result":"import { ssr as _$ssr } from \"solid-js/web\";\nimport { ssrAttribute as _$ssrAttribute } from \"solid-js/web\";\nimport { escape as _$escape } from \"solid-js/web\";\nimport { ssrHydrationKey as _$ssrHydrationKey } from \"solid-js/web\";\nconst _tmpl$ = [\"<link\", \" rel=\\\"stylesheet\\\"\", \">\"],\n  _tmpl$2 = [\"<link\", \" rel=\\\"modulepreload\\\"\", \">\"];\nimport { useContext } from \"solid-js\";\nimport { useAssets } from \"solid-js/web\";\nimport { ServerContext } from \"../server/ServerContext\";\nimport { routeLayouts } from \"./InlineStyles\";\nfunction flattenIslands(match, manifest) {\n  let result = [...match];\n  match.forEach(m => {\n    if (m.type !== \"island\") return;\n    const islandManifest = manifest[m.href];\n    if (islandManifest) {\n      const res = flattenIslands(islandManifest.assets, manifest);\n      result.push(...res);\n    }\n  });\n  return result;\n}\nfunction getAssetsFromManifest(manifest, routerContext) {\n  let match = routerContext.matches ? routerContext.matches.reduce((memo, m) => {\n    if (m.length) {\n      const fullPath = m.reduce((previous, match) => previous + match.originalPath, \"\");\n      const route = routeLayouts[fullPath];\n      if (route) {\n        memo.push(...(manifest[route.id] || []));\n        const layoutsManifestEntries = route.layouts.flatMap(manifestKey => manifest[manifestKey] || []);\n        memo.push(...layoutsManifestEntries);\n      }\n    }\n    return memo;\n  }, []) : [];\n  match.push(...(manifest[\"entry-client\"] || []));\n  match = manifest ? flattenIslands(match, manifest) : [];\n  const links = match.reduce((r, src) => {\n    r[src.href] = src.type === \"style\" ? _$ssr(_tmpl$, _$ssrHydrationKey(), _$ssrAttribute(\"href\", _$escape(src.href, true), false)) : src.type === \"script\" ? _$ssr(_tmpl$2, _$ssrHydrationKey(), _$ssrAttribute(\"href\", _$escape(src.href, true), false)) : undefined;\n    return r;\n  }, {});\n  return Object.values(links);\n}\n\n/**\n * Links are used to load assets for the server rendered HTML\n * @returns {JSXElement}\n */\nexport default function Links() {\n  const isDev = import.meta.env.MODE === \"development\";\n  const context = useContext(ServerContext);\n  !isDev && true && useAssets(() => getAssetsFromManifest(context.env.manifest, context.routerContext));\n  return null;\n}","start":1681089269438,"end":1681089269438,"order":"normal"},{"name":"vite:import-analysis","result":"import.meta.env = {\"BASE_URL\":\"/\",\"MODE\":\"development\",\"DEV\":true,\"PROD\":false,\"SSR\":true};import.meta.env.START_SSR = true;import.meta.env.START_ISLANDS = false;import.meta.env.START_ENTRY_CLIENT = \"D:\\\\Files\\\\Github\\\\thaler\\\\examples\\\\solidstart\\\\src\\\\entry-client.tsx\";import.meta.env.START_ENTRY_SERVER = \"D:\\\\Files\\\\Github\\\\thaler\\\\examples\\\\solidstart\\\\src\\\\entry-server.tsx\";import.meta.env.START_INDEX_HTML = false;import.meta.env.START_ISLANDS_ROUTER = false;import.meta.env.START_ADAPTER = \"solid-start-node\";import { ssr as _$ssr } from \"solid-js/web\";\nimport { ssrAttribute as _$ssrAttribute } from \"solid-js/web\";\nimport { escape as _$escape } from \"solid-js/web\";\nimport { ssrHydrationKey as _$ssrHydrationKey } from \"solid-js/web\";\nconst _tmpl$ = [\"<link\", \" rel=\\\"stylesheet\\\"\", \">\"],\n  _tmpl$2 = [\"<link\", \" rel=\\\"modulepreload\\\"\", \">\"];\nimport { useContext } from \"solid-js\";\nimport { useAssets } from \"solid-js/web\";\nimport { ServerContext } from \"/@fs/D:/Files/Github/thaler/node_modules/.pnpm/solid-start@0.2.26_@solidjs+meta@0.28.2_@solidjs+router@0.8.2_solid-js@1.7.2_solid-start-node@0.2.19_vite@4.2.1/node_modules/solid-start/server/ServerContext.tsx\";\nimport { routeLayouts } from \"/@fs/D:/Files/Github/thaler/node_modules/.pnpm/solid-start@0.2.26_@solidjs+meta@0.28.2_@solidjs+router@0.8.2_solid-js@1.7.2_solid-start-node@0.2.19_vite@4.2.1/node_modules/solid-start/root/InlineStyles.tsx\";\nfunction flattenIslands(match, manifest) {\n  let result = [...match];\n  match.forEach(m => {\n    if (m.type !== \"island\") return;\n    const islandManifest = manifest[m.href];\n    if (islandManifest) {\n      const res = flattenIslands(islandManifest.assets, manifest);\n      result.push(...res);\n    }\n  });\n  return result;\n}\nfunction getAssetsFromManifest(manifest, routerContext) {\n  let match = routerContext.matches ? routerContext.matches.reduce((memo, m) => {\n    if (m.length) {\n      const fullPath = m.reduce((previous, match) => previous + match.originalPath, \"\");\n      const route = routeLayouts[fullPath];\n      if (route) {\n        memo.push(...(manifest[route.id] || []));\n        const layoutsManifestEntries = route.layouts.flatMap(manifestKey => manifest[manifestKey] || []);\n        memo.push(...layoutsManifestEntries);\n      }\n    }\n    return memo;\n  }, []) : [];\n  match.push(...(manifest[\"entry-client\"] || []));\n  match = manifest ? flattenIslands(match, manifest) : [];\n  const links = match.reduce((r, src) => {\n    r[src.href] = src.type === \"style\" ? _$ssr(_tmpl$, _$ssrHydrationKey(), _$ssrAttribute(\"href\", _$escape(src.href, true), false)) : src.type === \"script\" ? _$ssr(_tmpl$2, _$ssrHydrationKey(), _$ssrAttribute(\"href\", _$escape(src.href, true), false)) : undefined;\n    return r;\n  }, {});\n  return Object.values(links);\n}\n\n/**\n * Links are used to load assets for the server rendered HTML\n * @returns {JSXElement}\n */\nexport default function Links() {\n  const isDev = import.meta.env.MODE === \"development\";\n  const context = useContext(ServerContext);\n  !isDev && true && useAssets(() => getAssetsFromManifest(context.env.manifest, context.routerContext));\n  return null;\n}","start":1681089269438,"end":1681089269441,"order":"normal"}]}
